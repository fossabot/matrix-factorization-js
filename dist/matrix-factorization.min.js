"use strict";function n(n){return r(n)?f(n[0].length,n.length,function(){return 0}).map(function(r,t){return r.map(function(r,o){return n[o][t]})}):n}function r(n){return Array.isArray(n[0])}function t(t,o){var e=n(o);return r(t)||r(o)?t.map(function(n){return e.map(function(r){return u(n,r)})}):u(t,o)}function o(n,r){return n.map(function(n){return n[r]})}function u(n,r){return e(n,r,function(n,r){return n*r}).reduce(function(n,r){return n+r})}function e(n,r,t){return n.map(function(n,o){return t(n,r[o])})}function i(n){return Math.pow(n,2)}function f(n,r){for(var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return 0},o=[],u=0;u<n;u++){o.push([]);for(var e=0;e<r;e++)o[u][e]=t()}return o}function a(n,r){for(var t=0;t++<n;)r()}var c={factorizeMatrix:function(r,u){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e-4,v=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.02,l=r.length,d=r[0].length,h=f(l,u,function(){return Math.random()}),m=n(f(d,u,function(){return Math.random()})),p=r.length,g=r[0].length;return a(e,function(){for(var n=0;n<p;n++)for(var e=0;e<g;e++){var f=r[n][e];if(f>0)for(var a=f-t(h[n],o(m,e)),l=0;l<u;l++)h[n][l]=h[n][l]+c*(2*a*m[l][e]-v*h[n][l]),m[l][e]=m[l][e]+c*(2*a*h[n][l]-v*m[l][e])}for(var d=0;d<p;d++)for(var s=0;s<g;s++){var x=r[d][s];if(x>0){i(x-t(h[d],o(m,s)));for(var M=0;M<u;M++)i(h[d][M]),i(h[M][s])}}}),[h,n(m)]},fillMatrix:f,transpose:n,dot:t};"undefined"!=typeof module&&module.exports?module.exports=c:window.matrixFactorization=c;